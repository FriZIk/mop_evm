<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1251">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.3  (Win32)">
	<META NAME="CREATED" CONTENT="20080924;550426">
	<META NAME="CHANGED" CONTENT="20080924;553464">
	<STYLE TYPE="text/css">
	<!--
		H3 { margin-top: 0.49cm; margin-bottom: 0.49cm; page-break-after: auto }
		H3.western { font-family: "Arial"; font-size: 13pt }
		H3.cjk { font-family: "Lucida Sans Unicode"; font-size: 13pt }
		H3.ctl { font-family: "Tahoma"; font-size: 13pt }
		H4 { margin-top: 0.49cm; margin-bottom: 0.49cm; page-break-after: auto }
		H4.western { font-family: "Arial"; font-size: 10pt }
		H4.cjk { font-family: "Lucida Sans Unicode"; font-size: 12pt }
		H4.ctl { font-family: "Tahoma"; font-size: 12pt }
		A:link { color: #0000ff }
	-->
	</STYLE>
</HEAD>
<BODY LANG="ru-RU" LINK="#0000ff" DIR="LTR">
<P LANG="en-US" ALIGN=RIGHT STYLE="margin-bottom: 0cm">www.citforum.ru</P>
<P ALIGN=RIGHT STYLE="margin-bottom: 0cm"><I>2000 г</I></P>
<H3 CLASS="western" ALIGN=CENTER>Где NT хранит пароли</H3>
<P ALIGN=CENTER STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm"><FONT COLOR="#0000ff"><U><A HREF="http://www.osp.ru/win2000/">WINDOWS
2000 MAGAZINE</A></U></FONT> #02/99<BR><I>Марк Джозеф Эдвард<BR>Дэвид
Лебланк</I> 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Наверняка вы
знаете о том, что пароли служат ключами к большинству &quot;дверей&quot;
в сети. А известно ли вам, где Windows NT 4.0 хранит эти пароли? Их
можно обнаружить во многих интересных местах. И для того, чтобы
обеспечить надежную защиту системы, необходимо располагать полной
информацией о них. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Для хранения и
обработки таких атрибутов пользователя, как пароли в ОС NT,
используется SAM (Security Accounts Manager - администратор учетных
данных в системе защиты). SAM размещает всю информацию в базе данных
SAM, поэтому можно сказать, что NT защищена от взлома настолько же,
насколько защищены данные SAM. Взломать систему безопасности SAM
непросто, только если не знать обо всех местах, где можно найти базу
данных SAM. Эта статья поможет вам защитить некоторые важные области
данных системы NT и отыскать участки системы, которые требуют
дальнейшего конфигурирования для обеспечения более высокого уровня
безопасности. 
</P>
<H4 CLASS="western">Ключи реестра SAM</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">NT хранит
постоянно используемую копию базы данных SAM на жестком диске. Вы
можете получить доступ к этой базе данных через реестр системы
(HKEY_LOCAL_MACHINE, ключ SAM), написав программу или используя
редактор реестра (например, regedt32.exe). В принципе, пользователи
не имеют доступа к ключу реестра SAM непосредственно из редактора
реестра, так как NT предоставляет права доступа к данному ключу
только системной учетной записи SYSTEM. Однако пользователи, имеющие
административные привилегии, могут воспользоваться трюком NT и
обеспечить доступ из пользовательской среды с правами SYSTEM. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Блокировка
службы Планировщика NT (NT Scheduler). Упомянутый выше трюк состоит в
использовании службы Планировщика NT для запуска редактора реестра на
системной консоли в некоторое заранее определенное время. По
умолчанию, Планировщик NT при выполнении заданий использует права
учетной записи SYSTEM. Поэтому любая программа, запущенная
Планировщиком, имеет полный набор системных привилегий, включая
доступ к базе данных SAM. Чтобы защититься от данной опасности,
приходится действовать жесткими методами, так как для этого
необходимо заблокировать службу Планировщика NT. Блокировка данной
службы не всегда возможна в связи с тем, что она может потребоваться
для запуска обычных заданий. Если вы не в состоянии заблокировать
службу Планировщика, постарайтесь сконфигурировать ее таким образом,
чтобы она работала от имени учетной записи пользователя (права
пользователя - это необходимый минимум для выполнения запланированных
заданий). 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Использование
технологии системного ключа (system key). Для обеспечения защиты SAM
вы также можете применить предлагаемую Microsoft технологию
системного ключа. Данная технология впервые появилась в составе
дополнений (hotfix) к пакету обновления NT Service Pack 2 (SP2), но
широкую известность она получила, когда вошла в состав SP3. (О
сервисном пакете SP3 читайте статью Service Pack 3 Is Really Security
Pack 3 в журнале Windows NT Magazine, август 1997.) Технология
системного ключа применяется для защиты NT и ее паролей посредством
шифрования базы данных SAM и требует использования ключа шифра при
загрузке операционной системы. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Можно
использовать один из трех вариантов системных ключей. 
</P>
<UL>
	<LI><P STYLE="margin-top: 0.49cm; margin-bottom: 0cm">Ключ
	формируется системой произвольным образом и хранится на системном
	диске с использованием специального алгоритма защиты от прочтения. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Ключ формируется системой
	произвольным образом и хранится на дискете. 
	</P>
	<LI><P STYLE="margin-bottom: 0.49cm">Для формирования ключа
	применяется пароль, выбираемый администратором. 
	</P>
</UL>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Более подробно о
каждом из этих вариантов можно прочитать в статье Microsoft: Windows
NT System Key Permits Strong Encryption of the SAM
(<FONT COLOR="#0000ff"><U><A HREF="http://support.microsoft.com/support/kb/articles/q143/4/75.asp">http://support.microsoft.com/support/kb/articles/q143/4/75.asp</A></U></FONT>).
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Хотя системный
ключ и помогает защитить SAM, прежде чем броситься в бой и начать его
устанавливать, следует осознать несколько важных моментов. Нужно
иметь в виду, что после установки syskey.exe на компьютере не
существует возможности его удаления. Следовательно, необходимо очень
внимательно отнестись к вопросу выбора оптимального для вашей системы
метода хранения ключа. Непосредственно после установки syskey.exe
нужно сформировать новую дискету ERD (Emergency Repair Disk). В
противном случае вы не сможете полностью восстановить систему, если
это потребуется. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Одно из реальных
преимуществ использования системного ключа состоит в том, что если
взломщикам удастся получить копию вашей базы данных SAM, они не
смогут вытащить оттуда действующие хэш-коды паролей. У них не будет
возможности применить для расшифровки паролей такие утилиты как
L0phtCrack от L0pht Heavy Industries. Но следует заметить, что
системный ключ не сможет остановить тех пользователей, которые имеют
административные привилегии. Эти пользователи могут выгрузить базу
данных SAM в формате, пригодном для взлома такими инструментами, как
L0phtCrack; поэтому нужно очень аккуратно назначать административные
права. Например, утилита Pwdump2 успешно получает хэш-коды паролей из
базы данных SAM, даже если используется технология системного ключа.
Следует учитывать потенциальную опасность, которую представляют
подобные инструменты. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Другим
преимуществом технологии системного ключа является возможность
обнаруживать попытки такого малоизвестного способа взлома, при
котором для получения доступа к системе применяются загрузочные
диски. Конечно, такой метод взлома возможен только в том случае, если
вы можете загрузиться с системного диска NT. Однако если это удается
сделать, то взломщик может перенести базу данных SAM в другое место и
затем перезагрузить компьютер. В процессе перезагрузки NT
обнаруживает отсутствие базы данных SAM и создает новую базу, которая
содержит только двух пользователей: Administrator и Guest, причем оба
имеют пустые пароли. Очевидно, что теперь взломщик может
зарегистрироваться в системе как Administrator, введя пустой пароль,
сделать все, что ему нужно, затем перезагрузиться со своего
системного диска и вернуть оригинальную копию базы данных SAM на
прежнее место. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">При
использовании системного ключа такую попытку взлома легко обнаружить.
Если на компьютере установлен системный ключ, то во время загрузки NT
не выдаст на экран обычного диалогового окна с приглашением для
регистрации. При таком поведении системы даже самый несообразительный
администратор должен задуматься и немедленно приступить к
исследованию проблемы. 
</P>
<H4 CLASS="western">Аудит SAM</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">При любых
обстоятельствах предусмотрительный администратор должен
активизировать аудит базы данных SAM, чтобы своевременно обнаруживать
какие-либо подозрительные действия. Разумеется, аудит предполагает,
что вы будете регулярно и тщательно просматривать журнал событий.
Процедура установки аудита SAM описана по шагам в колонке &quot;Установка
аудита системы безопасности&quot;. Также<SPAN LANG="en-US"> </SPAN>эта<SPAN LANG="en-US">
</SPAN>процедура<SPAN LANG="en-US"> </SPAN>описывается<SPAN LANG="en-US">
</SPAN>в<SPAN LANG="en-US"> </SPAN>статье<SPAN LANG="en-US">
Microsoft Enable Auditing of Microsoft Windows NT Server Password
Registry (</SPAN><FONT COLOR="#0000ff"><U><A HREF="http://support.microsoft.com/support/kb/articles/q186/"><SPAN LANG="en-US">http://support.microsoft.com/support/kb/articles/q186/
3/74.asp</SPAN></A></U></FONT><SPAN LANG="en-US">). </SPAN>Вы можете
активизировать аудит базы данных SAM, однако он не будет выполняться,
если кто-то загрузит систему с другой копии ОС. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Предположим, вы
сделали все, что нужно для установки аудита всей текущей базы данных
SAM. Теперь журнал событий будет включать в себя информацию обо всех
успешных и неудачных попытках доступа к ключам SAM. Однако эта
информация окажется бесполезной, если вы не будете внимательно
анализировать журнал. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Активизация
такого уровня аудита может привести к накоплению очень большого
количества записей в журнале событий. Дело в том, что в процессе
нормальной работы OC регулярно происходят обращения системы к ключам
SAM. Поэтому следует установить параметры настройки журнала событий
так, чтобы он мог вмещать достаточное количество записей. Также
следует настроить программы мониторинга журнала событий, которые вы
будете использовать. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Утилиты,
выполняющиеся с правами привилегированных пользователей, таких как
Administrator или SYSTEM, могут свободно манипулировать журналом
событий и записями в нем. Сообразительные взломщики могут легко
удалить все следы своей деятельности. 
</P>
<H4 CLASS="western">SAM на различных носителях информации</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">NT может
помещать базу данных SAM на различные носители информации, включая
дискеты, магнитные ленты и жесткие диски. Копирование базы на дискету
или ленту требует определенных действий со стороны пользователя,
такая операция не является частью обычной работы NT. В процессе
ежедневного функционирования NT может размещать базу данных SAM в
двух каталогах на жестком диске: %systemroot%\repair и
%systemroot%\system32\config. Хотя каталог \config и содержит рабочую
копию базы данных SAM, используемую &quot;живой&quot; системой, к
этой базе нельзя получить доступ (например, для копирования) из таких
программ, как Windows Explorer (Проводник), пока работает ОС. Это
связано с тем, что системный процесс Local Security Authority (LSA)
(lsass.exe) захватывает файл базы данных SAM для монопольного
использования. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Тем не менее
кто-нибудь все же может, используя загрузочный диск NT, скопировать
данный файл. То есть взломщик имеет возможность перезагрузить систему
со своего диска и скопировать либо переместить базу данных SAM. Еще
раз заметим, что технология системного ключа может защитить SAM от
подобной атаки с использованием загрузочного диска, так как база
данных будет зашифрована. Это справедливо и для архивов на магнитных
лентах, поскольку взятая оттуда копия базы данных SAM, зашифрованная
с помощью системного ключа, окажется совершенно бесполезной для
взломщика. Однако архивы на лентах все равно следует хранить под
замком для защиты от потери, искажения и кражи информации. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Каталог \repair
содержит ту же информацию, что и дискета ERD, создаваемая утилитой
rdisk.exe и используемая для восстановления системы. И каталог
\repair, и дискета ERD содержат копии базы данных SAM, поэтому они
должны быть надежно защищены. Дискета ERD должна храниться в столь же
безопасном месте, что и ленты с архивами данных. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Для защиты
каталога \repair назначайте права таким образом, чтобы злоумышленники
не могли получить доступ к данному каталогу и содержащимся в нем
файлам, в особенности к файлу sam._, в котором находится база данных
SAM. Чтобы защитить файлы в каталоге \repair, используйте утилиту
calcs.exe, входящую в состав Microsoft Windows NT Server 4.0 Resource
Kit или другую аналогичную программу. Выполните следующие действия. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">В окне Command
Prompt перейдите в каталог %systemroot% (обычно это C:\winnt) и
выполните команду: 
</P>
<P LANG="en-US" STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>cacls
repair /g administrators:F system:F /t</FONT></FONT></P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Либо вы можете,
используя программу Windows Explorer, сделать следующее. 
</P>
<OL>
	<LI><P STYLE="margin-top: 0.49cm; margin-bottom: 0cm">Откройте
	Windows Explorer.</P>
	<LI><P STYLE="margin-bottom: 0cm">Перейдите в каталог repair (обычно
	это C:\winnt\repair), нажмите правую клавишу мыши и выберите в
	открывшемся меню Properties.</P>
	<LI><P STYLE="margin-bottom: 0cm">Выберите закладку Security.</P>
	<LI><P STYLE="margin-bottom: 0cm">Выберите Permissions.</P>
	<LI><P STYLE="margin-bottom: 0cm">Отметьте<SPAN LANG="en-US">
	Replace Permissions on Subdirectories </SPAN>и<SPAN LANG="en-US">
	Replace Permissions on Existing Files.</SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm">Удалите из списка всех
	пользователей, кроме Administrators и SYSTEM.</P>
	<LI><P STYLE="margin-bottom: 0cm">Убедитесь<SPAN LANG="en-US">, </SPAN>что<SPAN LANG="en-US">
	</SPAN>и<SPAN LANG="en-US"> Administrators, </SPAN>и<SPAN LANG="en-US">
	SYSTEM </SPAN>имеют<SPAN LANG="en-US"> </SPAN>права<SPAN LANG="en-US">
	Full Control.</SPAN></P>
	<LI><P STYLE="margin-bottom: 0.49cm">Нажмите OK.</P>
</OL>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Теперь вы
назначили пользователям Administrators и SYSTEM права Full Control на
данный каталог и все файлы, которые в нем содержатся. Поскольку режим
редактирования ACL выбран не был, права всех остальных пользователей
удалены системой. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">В зависимости от
конфигурации системы помимо каталогов \repair и \config NT может
записывать информацию, имеющую отношение к SAM, в следующие файлы:
pagefile.sys, memory.dmp или user.dmp. NT использует файл
pagefile.sys как дополнительное пространство для организации
виртуальной памяти, которое добавляется к физической памяти,
установленной в компьютере. Файл memory.dmp создается при аварийном
завершении работы операционной системы, если в конфигурации NT выбран
режим записи образа памяти на диск. Файл user.dmp создается при
аварийном завершении работы какой-либо прикладной программы, если в
конфигурации программы Dr. Watson выбран режим записи образа памяти в
файл. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">При работе с
этими файлами NT переписывает определенную порцию данных из памяти на
диск. В некоторых случаях эти данные могут содержать пароли,
хранящиеся резидентно в памяти. Соответственно, получив доступ к этим
файлам, взломщик может без особого труда завладеть важной
информацией, позволяющей пробить брешь в системе безопасности. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Чтобы уменьшить
опасность, связанную с использованием файлов user.dmp и memory.dmp,
вам необходимо предпринять одно из следующих действий: 
</P>
<UL>
	<LI><P STYLE="margin-top: 0.49cm; margin-bottom: 0cm">написать
	командный файл, который будет удалять указанные файлы при входе в
	систему. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">установить права для этих файлов
	так, что только администраторы смогут иметь доступ к ним. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">установить в реестре ключ,
	указывающий на необходимость удаления системного файла pagefile при
	завершении работы операционной системы. 
	</P>
	<LI><P STYLE="margin-bottom: 0.49cm">в конфигурации программы Dr.
	Watson отключить режим создания файлов. 
	</P>
</UL>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Лучше всего
настроить параметры системы так, чтобы указанные два файла не
создавались. Однако при этом может возникнуть ситуация, когда
программисты, которые должны исследовать проблему аварийного
завершения работы системы, не будут иметь необходимых им данных. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Чтобы отключить
создание файлов user.dmp программой Dr. Watson запустите утилиту
drwtsn32.exe, отключите параметр Create Crash Dump File и закройте
программу. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Чтобы отключить
в параметрах настройки NT создание файла memory.dmp, запустите в
Панели Управления (Control Panel) программу System и выберите
закладку Startup/Shutdown. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Затем<SPAN LANG="en-US">
</SPAN>отключите<SPAN LANG="en-US"> </SPAN>параметр<SPAN LANG="en-US">
Write debugging information to. </SPAN>Если вам все же необходимо
иметь образы памяти на момент аварийного завершения работы NT,
постарайтесь настроить параметры ОС и программы Dr. Watson таким
образом, чтобы файлы, содержащие образ памяти, помещались в
защищенный каталог, доступный только администраторам. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Что касается
файла pagefile.sys, то его открывает и защищает от попыток
непосредственного доступа со стороны взломщиков только операционная
система. Однако следует упомянуть прошлогодний инцидент, когда
клиентская служба NetWare для Windows NT помещала в память пароли
пользователей NetWare в открытом виде. Эти пароли могли быть записаны
в файл pagefile.sys при переписывании соответствующей страницы памяти
на диск. Любой человек, имеющий копию файла pagefile.sys и текстовый
редактор, мог без труда получить пароли. Разработчики Novell решили
эту проблему. Теперь, прежде чем поместить пароли в pagefile, они
шифруются с использованием недокументированного API-интерфейса.
Однако взломщики могут пробить эту защиту. Так, изобретательные
российские программисты нашли способ расшифровки информации,
получаемой из файла pagefile.sys. Чтобы защититься от подобных атак,
настраивайте NT таким образом, чтобы файл pagefile.sys удалялся при
завершении работы системы. (Как это сделать, мы расскажем далее.) И
не забывайте о необходимости физической защиты компьютера с целью
предотвращения нежелательного доступа к файлу pagefile.sys. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Да, вы можете
сконфигурировать NT так, чтобы pagefile удалялся при нормальном
завершении работы системы. Но таким способом вы обеспечите защиту
только от тех взломщиков, которые копируют или изменяют файл,
загрузившись с другой копии ОС (т. е. используя загрузочный диск или
загрузив NT из другого системного каталога). Большинство взломщиков
понимают, что в таком случае у них есть возможность получения доступа
к системе путем перемещения базы данных SAM, следовательно, взлом
файла pagefile.sys становится бессмысленным 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Несмотря на это,
в ситуациях, когда условия эксплуатации системы требуют установки и
использования нескольких копий ОС, удаление файла pagefile при
нормальном завершении работы можно считать достаточной мерой
безопасности. Следует иметь в виду, что если NT сконфигурирована так,
чтобы удалять pagefile во время завершения работы системы, то
неизбежна некоторая задержка в процессе начальной загрузки и останова
ОС. Однако эта задержка несущественна, если принять во внимание
уровень безопасности, которого мы в результате достигаем. Для того
чтобы включить режим удаления файла pagefile.sys во время нормального
завершения работы ОС, следует модифицировать (или создать) в
системном реестре параметр ClearPageFileAtShutdown (типа REG_SZ) в
ключе HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
Manager\Memory Management, присвоив ему значение 1. 
</P>
<H4 CLASS="western">Хэш-коды паролей в памяти</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">По умолчанию, NT
кэширует необходимые для регистрации атрибуты для 10 последних
пользователей, входивших в систему интерактивно. Это делается для
того, чтобы пользователь смог зарегистрироваться, даже если вы
отключите компьютер от сети, или контроллер домена окажется
недоступным. NT обеспечивает определенную защиту кэшируемой
информации. Однако если ваши задачи требуют более высокого уровня
безопасности, вы можете полностью отключить кэширование, чтобы
исключить попытки атак на данные в кэш-памяти. Нужно учитывать, что
кэшируемые данные содержат хэш-коды других хэш-кодов паролей. Поэтому
их очень сложно взломать и использовать для несанкционированного
входа в систему. Мы не можем вспомнить ни одного случая использования
хакерами таких данных из кэш-памяти. Чтобы отключить кэширование,
установите в 0 значение параметра реестра CachedLogonsCount (типа
REG_DWORD) в ключе HKEY_
LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ Winlogon. 
</P>
<H4 CLASS="western">SAM в сети</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">ОС Windows NT
использует протокол SMB (Server Message Block - блок серверных
сообщений), разработанный совместно фирмами Microsoft, IBM и Intel.
Данный протокол определяет алгоритмы функционирования файловой службы
в сетевой среде. Нетрудно предположить, что во время сеанса SMB по
сети должны передаваться пакеты, содержащие информацию
конфиденциального характера. Среди прочего эти пакеты обычно включают
в себя зашифрованные данные протокола NTLM, передаваемые NT во время
фазы аутентификации. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Взломщики,
используя существующие сетевые анализаторы, могут легко перехватывать
данные, передаваемые по сети. Задача перехвата нужных пакетов и
получения из них информации о паролях всегда считалась нелегкой. Но
ситуация в корне изменилась с появлением продукта SMB Packet Capture,
выпущенного компанией L0pht Heavy Industries. Это сетевой анализатор,
который тесно интегрирован с программой L0phtCrack. Имея в своем
распоряжении L0phtCrack, можно легко &quot;выхватывать&quot; из сети
хэш-коды паролей, передаваемые в соответствии с протоколом SMB. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Встроенный в
L0phtCrack сетевой анализатор незаметно перехватывает хэш-коды
паролей и запоминает их с целью расшифровки. После расшифровки
паролей злоумышленнику ничего не стоит добраться до любого сетевого
ресурса, к которому имел доступ соответствующий пользователь. Вот
так! Риск здесь очевидный, но и методы защиты просты. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Для защиты от
подобных атак нужно использовать протокол NTLMv2, поставляемый в
составе пакетов обновления SP4 и SP5, либо применять механизм
создания виртуальных частных сетей (VPN - Virtual Private Network)
типа Microsoft PPTP. Протокол NTLMv2 позволяет защитить данные,
передаваемые по внутренней локальной сети, а PPTP обеспечивает защиту
информации, передаваемой через такие &quot;небезопасные&quot; сети,
как, например, Internet. Если вы реализуете PPTP, то обязательно
установите последние сервисные пакеты, включая дополнения и
исправления к ним (hotfix). Мы предупреждаем вас об этом, потому что
в свое время PPTP-соединение считалось очень ненадежным. Microsoft
внесла необходимые корректировки, устраняющие недостатки PPTP. Но эти
корректировки будут вам недоступны, если вы не установите hotfix к
пакету SP3 или более позднему пакету. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Следует иметь в
виду, что при отсутствии в вашей системе механизма VPN и технологии
подписей SMB взломщик может использовать сеанс SMB для получения
несанкционированного доступа в систему. Microsoft реализовала
технологию подписей SMB в пакете обновления SP3 и также включила ее
во все последующие пакеты обновления. При использовании подписей
пакетов SMB операционная система проверяет подлинность каждого
пакета, прежде чем принять его к исполнению. Однако реализация
подписей SMB не всегда безопасна. Для получения более подробной
информации обязательно прочитайте статью <SPAN LANG="en-US">Microsoft
How to Enable SMB Signing in Windows NT
(</SPAN><FONT COLOR="#0000ff"><U><A HREF="http://support.microsoft.com/support/kb/articles/q161/3/72.asp"><SPAN LANG="en-US">http://support.microsoft.com/support/kb/articles/q161/3/72.asp</SPAN></A></U></FONT><SPAN LANG="en-US">).
</SPAN>
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Для борьбы со
средствами взлома типа L0phtCrack можно запретить NT посылать в сеть
хэш-коды паролей, формируемые по протоколу LAN Manager (LM). Хэш-коды
LM являются более простыми, чем коды NTLM, так как NTLM позволяет
задействовать пароли, учитывающие регистр. Также NTLM допускает
возможность применения дополнительных символов клавиатуры. Это
расширяет диапазон символов ключа шифрования на 26. Заметим, что
сложные пароли труднее поддаются расшифровке даже при наличии таких
инструментов, как L0phtCrack. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Целесообразно
включать в пароль символ &quot;возврат каретки&quot;, так как
L0phtCrack не умеет нормально обрабатывать этот символ. Чтобы
вставить &quot;возврат каретки&quot;, нажмите клавиши Alt+0+1+3 на
цифровой панели клавиатуры. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Для решения
описываемой проблемы Microsoft реализовала в составе дополнений и
исправлений к сервисному пакету SP3 новый ключ реестра. Он был
включен во все сервисные пакеты, вышедшие после SP3. Новый параметр
реестра, LMCompatibilityLevel, имеет тип REG_DWORD и размещается в
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">При
использовании NTLMv2 можно установить значение этого параметра равным
0, 1, 2, 3, 4 и 5. Если это значение равно 0, то NT при
аутентификации сетевого соединения передает по сети пароли как в
формате NTLM, так и в формате LM (этот метод аутентификации
обеспечивает совместимость с другими системами и используется в NT по
умолчанию). Если значение равно 1, то NT передает оба типа хэш-кодов
только тогда, когда этого требует сервер. Если значение равно 2, то
хэш-коды паролей в формате LM не используются ни при каких
обстоятельствах. Если значение равно 3, применяется только
аутентификация по протоколу NTLMv2. Значение параметра, равное 4,
запрещает контроллеру домена использовать аутентификацию LM, а
значение 5 указывает на необходимость применять при аутентификации
только протокол NTLMv2. Наиболее безопасной является установка
значения этого параметра равным 2. Но следует иметь в виду, что
системы, поддерживающие только протокол LM (т. е. Windows 95 и
Windows for Workgroups), не смогут установить соединение с данной
системой NT. Полный перечень особенностей конфигурации описан в
статье Microsoft How to Disable LM Authentication on Windows NT
(<FONT COLOR="#0000ff"><U><A HREF="http://support.microsoft.com/support/kb/articles/q147/7/06.asp">http://support.microsoft.com/support/kb/articles/q147/7/06.asp</A></U></FONT>).
Заметим, что при установке пакета обновления SP4 данный ключ реестра
способен принимать шесть различных значений. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Еще один способ
взлома системы может иметь место, если взломщик располагает
возможностью физического доступа к компьютеру. Используя такие
средства, как NT Locksmith или ERD Commander (оба можно найти на
<FONT COLOR="#0000ff"><U><A HREF="http://www.wininternals./">http://www.wininternals.
com</A></U></FONT>), ничего не стоит получить доступ в систему с
правами любого пользователя. Для защиты от этого метода взлома
следует принять меры, препятствующие физическому доступу к
компьютеру. 
</P>
<H4 CLASS="western">Можно немного расслабиться</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">В этой статье мы
представили основные идеи и особенности конфигурации, которые следует
учитывать при установке и сопровождении ОС Windows NT и ее системы
безопасности. Также мы упомянули несколько вопросов, связанных с
приложениями NT (см. колонки &quot;Безопасность приложений
BackOffice&quot; и &quot;Безопасность прикладных программ&quot;),
которые проливают свет на потенциальные проблемы и могут
способствовать поиску путей защиты паролей от несанкционированного
доступа. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Эта статья
должна помочь вам несколько разгрузить свой мозг. Но не слишком
расслабляйтесь. Вам по-прежнему необходимо держать систему под
контролем. Продолжайте следить за журналами событий! 
</P>
<H4 CLASS="western">Об авторах</H4>
<P STYLE="margin-bottom: 0cm"><I><B>Марк Джозеф Эдвардс</B></I><I> -
сетевой инженер с 16-летним опытом работы. Он</I><SPAN LANG="en-US"><I>
</I></SPAN><I>является</I><SPAN LANG="en-US"><I> </I></SPAN><I>автором</I><SPAN LANG="en-US"><I>
</I></SPAN><I>книги</I><SPAN LANG="en-US"><I> Internet Security with
Windows NT (</I></SPAN><I>издательство</I><SPAN LANG="en-US"><I> 29th
Street Press). </I></SPAN><I>С ним можно связаться по электронной
почте по адресам </I><FONT COLOR="#0000ff"><U><A HREF="mailto:mark@ntshop.net"><I>mark@ntshop.net</I></A></U></FONT><I>
или </I><FONT COLOR="#0000ff"><U><A HREF="mailto:mje@winntmag.com"><I>mje@winntmag.com</I></A></U></FONT><I>.<BR></I><I><B>Дэвид
Лебланк</B></I><I> более пять лет занимается вопросами безопасности
Windows NT, является старшим технологом группы по компьютерной
безопасности корпорации Microsoft. C ним можно связаться по
электронной почте по адресу </I><FONT COLOR="#0000ff"><U><A HREF="mailto:dleblanc@mindspring.com"><I>dleblanc@mindspring.com</I></A></U></FONT><I>.</I>
</P>
<H4 CLASS="western">Установка аудита системы безопасности 
</H4>
<OL>
	<LI><P STYLE="margin-top: 0.49cm; margin-bottom: 0cm">Войдите в
	систему с административными правами. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Запустите<SPAN LANG="en-US">
	</SPAN>программу<SPAN LANG="en-US"> User Manager. </SPAN>Выберите<SPAN LANG="en-US">
	</SPAN>в<SPAN LANG="en-US"> </SPAN>меню<SPAN LANG="en-US">:
	Policies, Audit </SPAN>и<SPAN LANG="en-US"> </SPAN>отметьте<SPAN LANG="en-US">
	Audit These Events. </SPAN>
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Выделите для аудита (по минимуму)
	события с успешным (Success) и неудачным (Failure) результатом
	выполнения; включите аудит попыток входа в систему и выхода из нее
	(Logon, Logoff). Закройте диалоговое окно, чтобы активизировать
	аудит системы. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Откройте программу Services в
	Панели Управления (Control Panel), установите для службы
	Планировщика NT (NT Scheduler) режим запуска от имени системы
	(System account). Запустите (или перезапустите) службу Планировщика.
		</P>
	<LI><P STYLE="margin-bottom: 0cm">Откройте командное окно DOS и
	проверьте текущее системное время. 
	</P>
	<LI><P STYLE="margin-bottom: 0.49cm">Прибавьте к текущему времени
	1-2 минуты (так, если время 11:30, используйте 11:32) и введите
	следующую команду: 
	</P>
</OL>
<P STYLE="margin-left: 1.27cm; margin-bottom: 0cm">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>at
11:32 /interactive &quot;regedt32.exe&quot;</FONT></FONT></P>
<P STYLE="margin-left: 1.27cm; margin-top: 0.49cm; margin-bottom: 0.49cm">
Эта команда вставляет в список Планировщика событие, по которому в
11:32 на консоли будет запущена утилита regedt32 с правами SYSTEM. 
</P>
<OL START=7>
	<LI><P STYLE="margin-top: 0.49cm; margin-bottom: 0cm">Дождитесь
	11:32, когда Планировщик NT запустит редактор реестра. При этом вы
	получите доступ ко всему реестру, включая базу данных SAM. Будьте
	внимательны при редактировании реестра - ошибка может вывести из
	строя систему. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Выберите HKEY_LOCAL_MACHINE,
	найдите дерево SAM и выделите его в левой панели экрана. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Выберите<SPAN LANG="en-US"> </SPAN>в<SPAN LANG="en-US">
	</SPAN>меню<SPAN LANG="en-US">: Security, Auditing. </SPAN>
	</P>
	<LI><P STYLE="margin-bottom: 0cm">В<SPAN LANG="en-US"> </SPAN>диалоговом<SPAN LANG="en-US">
	</SPAN>окне<SPAN LANG="en-US"> Auditing </SPAN>выберите<SPAN LANG="en-US">
	Add, Show Users. </SPAN>
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Добавьте учетную запись SYSTEM,
	группу Domain Admins, все учетные записи пользователей, имеющих
	административные права, а также все остальные учетные записи,
	которым присвоены следующие права (User Rights): 
	</P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US">Take ownership
		of files or other objects (</SPAN>Овладение<SPAN LANG="en-US">
		</SPAN>файлами<SPAN LANG="en-US"> </SPAN>или<SPAN LANG="en-US">
		</SPAN>иными<SPAN LANG="en-US"> </SPAN>объектами<SPAN LANG="en-US">)
		</SPAN>
		</P>
		<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US">Back up files
		and directories (</SPAN>Архивирование<SPAN LANG="en-US"> </SPAN>файлов<SPAN LANG="en-US">
		</SPAN>и<SPAN LANG="en-US"> </SPAN>каталогов<SPAN LANG="en-US">) </SPAN>
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Manage auditing and security log
		(Управление аудитом и журналом безопасности) 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Restore files and directories
		(Восстановление файлов и каталогов) 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Add workstations to domain
		(Добавление рабочих станций к домену) 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Replace a process-level token
		(Замена маркера уровня процесса) 
		</P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm">Отметьте<SPAN LANG="en-US">: Audit
	Permission on Existing Subkeys </SPAN>
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Отметьте Success и Failure для
	следующих полей: 
	</P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm">Query Value 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Set Value 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Write DAC 
		</P>
		<LI><P STYLE="margin-bottom: 0cm">Read Control 
		</P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm">Нажмите кнопки OK, Yes. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Повторите шаги с 10 по 14 для
	ключа SECURITY, если это необходимо. Это не требуется, если вам
	нужно активизировать аудит только тех ключей, которые содержат
	пароли.</P>
	<LI><P STYLE="margin-bottom: 0cm">Выйдите из редактора реестра. 
	</P>
	<LI><P STYLE="margin-bottom: 0.49cm">Остановите службу Планировщика
	и измените его конфигурацию так, чтобы он работал от имени
	пользователя, которое употреблялось ранее (до шага 4). Если вы не
	применяете в обычной работе системы Планировщик NT, то просто
	остановите его или, еще лучше, заблокируйте (вариант disabled).</P>
</OL>
<P STYLE="margin-bottom: 0cm"><IMG SRC="dop.win2000_sam_html_m46f6683d.gif" ALIGN=BOTTOM WIDTH=743 HEIGHT=3></P>
<H4 CLASS="western">Безопасность приложений BackOffice 
</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Многие
прикладные программы, работающие в среде Windows NT, используют
пароли, которые хранятся не в базе данных SAM. Такие приложения, как
Microsoft Outlook, Internet Explorer (IE), Internet Information
Server (IIS), SQL Server, - размещают пароли в различных областях
системы. Нужно иметь представления обо всех этих областях и принимать
меры для предотвращения нежелательного доступа в систему. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Одно из наиболее
распространенных приложений в NT - Internet Explorer. Сам IE не
требует ввода паролей, однако этого требуют многие узлы, доступ к
которым осуществляется с помощью IE. Слабый дизайн Web-узлов обычно
приводит к появлению проблем в области безопасности. В особенности
это происходит, когда необходимые для входа на сайт имена
пользователей и пароли размещаются в специальных модулях настройки
клиентов, называемых cookies. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Срок жизни
модулей настройки клиентов можно программировать, следовательно,
можно указать, что он истекает немедленно.Тогда эти данные будут
оставаться в памяти только в тот период, когда они используются в
текущей работе с узлом, и никогда не будут записаны на диск. Модули,
содержащие имена пользователей и пароли, срок жизни которых не истек,
NT сразу же записывает в каталог
%systemroot%\profiles\username\cookies. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Любой, кому
доступен этот каталог, имеет доступ ко всем данным, хранящимся в
модулях настройки клиентов, включая такую информацию, как имена
пользователей и пароли. Злонамеренный оператор Web-узла, знающий, где
нужно искать соответствующую информацию, сможет найти ее в каталоге
cookies. И пользователь ничего не будет знать об этом. Эта ситуация
не является дырой в системе безопасности IE. Это просто особенность
алгоритмов работы HTML Cookies. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Чтобы защититься
от этого, необходимо просто проверять и удалять все модули cookies,
которые содержат конфиденциальную информацию. Для этого достаточно
открыть соответствующий файл текстовым редактором и посмотреть, что в
нем находится. Также нужно во всеуслышание жаловаться на те узлы,
которые хранят конфиденциальную информацию в файлах на диске,
поскольку такая практика содержит в себе серьезную угрозу
безопасности. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Клиент Outlook
во время обычной работы нигде не хранит в системе паролей в открытом
текстовом виде. Однако если вы работаете с сервером по протоколу
POP3, то пароли передаются по сети в явном виде. Такие пароли можно
легко перехватить с помощью сетевого анализатора пакетов. Протокол
POP3 требует передачи открытых паролей, поэтому Microsoft ничего не
может сделать для решения этой проблемы. Но несмотря на это, для
приема почтовых сообщений можно использовать вместо POP3 протокол
APOP (Authenticated Post Office Protocol). Этот протокол работает с
зашифрованными паролями. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">SQL Server при
аутентификации пользователей хранит пароли в системном реестре.
Соответствующие ключи реестра очень слабо защищены. Например, когда
вы регистрируете SQL-сервер с использованием SQL Executive, имя
пользователя и пароль для этого сервера записываются в реестр, в
дерево HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer. И любой
сообразительный пользователь, имеющий право непосредственной
регистрации с консоли сервера, может легко получить пароли
SQL-серверов. Поэтому будьте внимательны при назначении пользователям
прав регистрации на серверах с локальной консоли. Желательно также
запретить удаленный доступ к реестру на всех системах NT, где это
возможно. Но это следует очень аккуратно планировать, так как многим
системам управления сетью и многим программам установки необходимо
использовать удаленный доступ к реестру. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Недавно было
обнаружено, что при установке пакета Microsoft BackOffice Server
пароли пользователей остаются записанными на диск в явном виде в
областях файловой системы, доступных обычному пользователю. Во время
инсталляции создается файл reboot.ini в каталоге \program
files\microsoft backoffice. Если пользователь в процессе установки
Backoffice 4.0 выбирает установку продуктов SQL Server, Exchange
Server или Microsoft Transaction Server (MTS), то программа установки
запрашивает имя и пароль для пользователей, необходимые для работы
данных продуктов. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Если подробнее,
то программа установки запрашивает имена и пароли пользователей, от
имени которых работают SQL Executive, Exchange Services и MTS Remote
Administrator, и сохраняет эту информацию в виде открытого текста в
файле reboot.ini. После завершения установки программе не удается
удалить этот файл. Позаботьтесь о том, чтобы не предоставлять
излишних прав доступа системам BackOffice. Если вы имеете достаточно
надежную систему безопасности, то вряд ли вы столкнетесь с описанной
проблемой. Но, несмотря на это, обязательно удалите вручную этот файл
после завершения установки BackOffice 4.0. Более подробная информация
по этой проблеме изложена в статье Microsoft BackOffice Installer
Tool Does Not Delete Password Cache File
(<FONT COLOR="#0000ff"><U><A HREF="http://support.microsoft.com/support/kb/articles/q217/0/04.asp">http://support.microsoft.com/support/kb/articles/q217/0/04.asp</A></U></FONT>).
</P>
<P STYLE="margin-bottom: 0cm"><IMG SRC="dop.win2000_sam_html_39eb589d.gif" ALIGN=BOTTOM WIDTH=803 HEIGHT=3></P>
<H4 CLASS="western">Безопасность прикладных программ 
</H4>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Многие компании,
занимающиеся разработкой программного обеспечения, не слишком много
внимания уделяют вопросам безопасности. И если внимательно посмотреть
вокруг, то можно заметить, что программисты - это далеко не всегда
люди, озабоченные проблемами безопасности. Большинство программистов
начинают думать о безопасности уже после того, как кто-то взламывает
программу, или программа позволяет взломать всю систему или сеть. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Многие
программные продукты имеют уязвимые места с точки зрения
безопасности. Одним из таких продуктов является СУБД Oracle. Эта СУБД
хранит в системе конфиденциальную информацию в виде открытого текста.
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Отсюда вытекает
мораль: необходимо обеспечивать защиту собственными силами,
отслеживая состояние системы до, во время и после установки новых
программ, в особенности если эти программы не являются широко
известными коммерческими продуктами. Отслеживать состояние системы
удобно при помощи утилиты Sysdiff, входящей в состав пакета Microsoft
Windows NT Workstation 4.0 Resource Kit. Посредством Sysdiff вы
можете создать образ системного реестра перед установкой новых
продуктов и затем сравнить его с реально используемым реестром после
установки программ. Утилита Sysdiff отображает все различия между
двумя образами реестра. В качестве альтернативного варианта можно
использовать утилиту Regmon (ее можно найти на Web-сайте
Sysinternals: <FONT COLOR="#0000ff"><U><A HREF="http://www.sysinternals.com/">http://www.sysinternals.com</A></U></FONT>).
Данная утилита позволяет наблюдать за доступом к реестру в реальном
времени. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Что касается
файловой системы, вы можете сделать сравнение ее состояния до и после
установки. Это поможет выявить, какие файлы были удалены или
добавлены во время установки нового продукта. Чтобы сделать такое
сравнение, можно использовать утилиту Windiff из набора Resource Kit.
Это делается следующим образом. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Прежде чем
установить новый программный продукт, откройте окно DOS и перейдите в
корневой каталог диска, с которым вы собираетесь работать (например,
C:\). Чтобы создать текстовый файл, содержащий полную структуру
файлов и каталогов, введите команду 
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New, monospace"><FONT SIZE=2>dir
/S &gt; directory1.txt</FONT></FONT></P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Эта команда
создает файл directory1.txt, включающий в себя список всех каталогов
и файлов, расположенных на текущем диске. Создайте такие файлы для
всех дисков, имеющихся у вас в системе, назначая разные имена файлов
для каждого диска. После завершения установки нового программного
продукта точно так же создайте еще один набор файлов, назначая другие
имена файлов. Затем, используя утилиту Windiff, выполните сравнение
структур каталогов, содержащихся в соответствующих созданных файлах.
В результате Windiff отобразит все каталоги и файлы, которые были
удалены, добавлены или модифицированы во время установки. Обязательно
прочитайте справочный файл Windiff, который содержит подробные
инструкции по работе с данной утилитой. 
</P>
<P STYLE="margin-top: 0.49cm; margin-bottom: 0.49cm">Также для
получения информации о текущей работе с файловой системой вы можете
использовать утилиту Filemon (доступную на сайте Sysinternals).
Совместное использование Filemon или Windiff является удачным
решением, так как оно позволяет выявить прикладные программы, которые
без вашего ведома считывают конфиденциальную информацию из системы. 
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
</BODY>
</HTML>